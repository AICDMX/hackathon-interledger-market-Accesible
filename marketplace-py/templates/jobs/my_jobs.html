{% extends 'base.html' %}
{% load i18n audio_tags %}

{% block title %}{% trans 'My Jobs' %} - {{ block.super }}{% endblock %}

{% block content %}
{% load audio_tags %}
{% include 'components/static_title_with_audio.html' with title_text="My Posted Jobs" slug="page_my_posted_jobs" heading_tag="h1" %}

<div class="card">
    <form method="get" action="{% url 'jobs:my_jobs' %}">
        <div class="form-group">
            <label for="status">{% trans 'Filter by Status' %}</label>
            <select id="status" name="status">
                <option value="">{% trans 'All Statuses' %}</option>
                <option value="draft" {% if status_filter == 'draft' %}selected{% endif %}>{% trans 'Draft' %}</option>
                <option value="recruiting" {% if status_filter == 'recruiting' %}selected{% endif %}>{% trans 'Recruiting' %}</option>
                <option value="selecting" {% if status_filter == 'selecting' %}selected{% endif %}>{% trans 'Selecting' %}</option>
                <option value="submitting" {% if status_filter == 'submitting' %}selected{% endif %}>{% trans 'Submitting' %}</option>
                <option value="reviewing" {% if status_filter == 'reviewing' %}selected{% endif %}>{% trans 'Reviewing' %}</option>
                <option value="expired" {% if status_filter == 'expired' %}selected{% endif %}>{% trans 'Expired' %}</option>
                <option value="complete" {% if status_filter == 'complete' %}selected{% endif %}>{% trans 'Complete' %}</option>
            </select>
        </div>
        <div style="display: flex; align-items: center; gap: 0.5rem;">
            <button type="submit" class="btn btn-primary">{% trans 'Filter' %}</button>
            {% audio_player_static_ui "button_filter" "label" %}
        </div>
    </form>
</div>

{% if jobs %}
    <div role="list" aria-label="{% trans 'My job listings' %}">
        {% for job in jobs %}
            <article class="card" role="listitem">
                {% include 'components/title_with_audio.html' with title=job.title content_object=job field_name="title" heading_tag="h2" link_url_name="jobs:detail" link_url_arg=job.pk %}
                <p><strong>{% trans 'Status' %}:</strong> {{ job.get_status_display }}</p>
                <p><strong>{% trans 'Budget' %}:</strong> {{ job.budget }} pesos</p>
                <p><strong>{% trans 'Submissions' %}:</strong> {{ job.submissions.count }}</p>
                <div style="display: flex; align-items: center; gap: 0.5rem; flex-wrap: wrap;">
                    <a href="{% url 'jobs:detail' job.pk %}" class="btn btn-primary">{% trans 'View Details' %}</a>
                    {% audio_player_static_ui "button_view_details" "label" %}
                    {% if job.status == 'draft' %}
                        <a href="{% url 'jobs:edit' job.pk %}" class="btn btn-primary">{% trans 'Edit' %}</a>
                        {% audio_player_static_ui "button_edit" "label" %}
                    {% endif %}
                    <form method="post" action="{% url 'jobs:duplicate' job.pk %}" style="display: inline;">
                        {% csrf_token %}
                        <div style="display: inline-flex; align-items: center; gap: 0.5rem;">
                            <button type="submit" class="btn btn-secondary">{% trans 'Duplicate' %}</button>
                            {% audio_player_static_ui "button_duplicate" "label" %}
                        </div>
                    </form>
                </div>
            </article>
        {% endfor %}
    </div>
{% else %}
    <div class="card">
        <p>{% trans 'You have not posted any jobs yet.' %}</p>
        <div style="display: flex; align-items: center; gap: 0.5rem;">
            <a href="{% url 'jobs:create' %}" class="btn btn-primary">{% trans 'Create Your First Job' %}</a>
            {% audio_player_static_ui "button_create_first_job" "label" %}
        </div>
    </div>
{% endif %}
{% endblock %}
